"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[583],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return u}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,s=m(e,["components","mdxType","originalType","parentName"]),c=l(n),u=r,h=c["".concat(p,".").concat(u)]||c[u]||d[u]||i;return n?a.createElement(h,o(o({ref:t},s),{},{components:n})):a.createElement(h,o({ref:t},s))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var m={};for(var p in t)hasOwnProperty.call(t,p)&&(m[p]=t[p]);m.originalType=e,m.mdxType="string"==typeof e?e:r,o[1]=m;for(var l=2;l<i;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5149:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return m},contentTitle:function(){return p},metadata:function(){return l},toc:function(){return s},default:function(){return c}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],m={},p="Map Porting (between AW, MWR, MW2:CR)",l={unversionedId:"map-porting-s1",id:"map-porting-s1",isDocsHomePage:!1,title:"Map Porting (between AW, MWR, MW2:CR)",description:"Doing a quick read of the Zonetool Basics will explain many things that are talked about on this guide. We recommend checking the commands for Zonetool and to check whether you can port from your desired game to the new one.",source:"@site/docs/map-porting-s1.md",sourceDirName:".",slug:"/map-porting-s1",permalink:"/map-porting-s1",editUrl:"https://github.com/h1-mod/docs/blob/main/docs/map-porting-s1.md",tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Map Porting (COD4/MW2/MW3 -> MWR/S1/MW2:CR)",permalink:"/map-porting-iw5"},next:{title:"Installing custom maps",permalink:"/map-arena-files"}},s=[{value:"Extra steps",id:"extra-steps",children:[],level:3},{value:"Red images",id:"red-images",children:[],level:3},{value:"&quot;REF&quot; red models",id:"ref-red-models",children:[],level:3},{value:"Textures are black/gray/white/red",id:"textures-are-blackgraywhitered",children:[],level:3},{value:"Vertex type X doesn&#39;t have the information used by shader Y in material Z",id:"vertex-type-x-doesnt-have-the-information-used-by-shader-y-in-material-z",children:[],level:3},{value:"Bad weaponinfo X specified for turret. It likely needs to be precached in script.",id:"bad-weaponinfo-x-specified-for-turret-it-likely-needs-to-be-precached-in-script",children:[],level:3},{value:"animation &#39;X&#39; not defined in anim tree &#39;{animtree name}&#39;",id:"animation-x-not-defined-in-anim-tree-animtree-name",children:[],level:3}],d={toc:s};function c(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"map-porting-between-aw-mwr-mw2cr"},"Map Porting (between AW, MWR, MW2:CR)"),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Doing a quick read of the ",(0,i.kt)("a",{parentName:"p",href:"zonetool-basics"},"Zonetool Basics")," will explain ",(0,i.kt)("strong",{parentName:"p"},"many things")," that are talked about on this guide. We recommend checking the ",(0,i.kt)("a",{parentName:"p",href:"zonetool-basics#commands"},"commands for Zonetool")," and to check whether ",(0,i.kt)("a",{parentName:"p",href:"zonetool-basics#game-conversion-support"},"you can port from your desired game to the new one"),"."))),(0,i.kt)("p",null,"To port maps between any next-gen game, you must use ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Joelrau/x64-zt"},"x64-zt"),", which you can ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Joelrau/x64-zt/releases/tag/latest"},"download by clicking right here.")),(0,i.kt)("p",null,"Once you find the map you want to dump, you need to find the zone for it. In this guide, we are porting ",(0,i.kt)("strong",{parentName:"p"},"Greenband")," from AW to MWR, so look in the zone folder for anything mentioning the map or theme. (For example, it is ",(0,i.kt)("inlineCode",{parentName:"p"},"mp_greenband")," in the AW zone folder)"),(0,i.kt)("p",null,"Now use the ",(0,i.kt)("inlineCode",{parentName:"p"},"dumpmap <target game> <zone>")," command and wait for your zone to dump. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Run the command at ",(0,i.kt)("inlineCode",{parentName:"li"},"dumpmap h1 mp_greenband")),(0,i.kt)("li",{parentName:"ol"},"Find the finalized dumped zone folder at ",(0,i.kt)("inlineCode",{parentName:"li"},"%S1 game files%/dump/mp_greenband/")),(0,i.kt)("li",{parentName:"ol"},"Move the dumped folder to ",(0,i.kt)("inlineCode",{parentName:"li"},"%MWR game files%/zonetool/mp_greenband/")),(0,i.kt)("li",{parentName:"ol"},"Open x64-zt, and run the command ",(0,i.kt)("inlineCode",{parentName:"li"},"generatecsv <zone>")," ",(0,i.kt)("em",{parentName:"li"},"(example: ",(0,i.kt)("inlineCode",{parentName:"em"},"generatecsv mp_greenband"),")"))),(0,i.kt)("p",null,"After you've generated your CSV, your map can now be built. Simply run ",(0,i.kt)("inlineCode",{parentName:"p"},"buildzone mp_greenband")," to build the map."),(0,i.kt)("h3",{id:"extra-steps"},"Extra steps"),(0,i.kt)("p",null,"For the map to look correct, you must create a GSC file for your map. This will be a script that will be executed once the map starts. This script differs on multiplayer & singleplayer. Dumping a map from S1 or H2 should have a map GSC you can use or reference to make a new one."),(0,i.kt)("p",null,"Multiplayer:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},'main()\n{\n    maps\\createfx\\mapname_fx::main();\n    maps\\mp\\mapname_fx::main();\n    maps\\mp\\_load::main();\n    maps\\mp\\_compass::setupminimap("compass_map_mapname");  // change compass name here\n}\n')),(0,i.kt)("p",null,"Singleplayer:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},'main()\n{\n    maps\\createfx\\mapname_fx::main(); // only if this script exists\n    maps\\mapname_fx::main(); // only if this script exists\n    maps\\_load::main();\n    maps\\_compass::setupminimap("compass_map_mapname"); // change compass name here\n}\n')),(0,i.kt)("h3",{id:"red-images"},"Red images"),(0,i.kt)("p",null,"Red images indicates that you are missing images. Dump the source game's common fastfile ",(0,i.kt)("em",{parentName:"p"},"(most of the time it is called ",(0,i.kt)("inlineCode",{parentName:"em"},"common_mp")," for multiplayer and ",(0,i.kt)("inlineCode",{parentName:"em"},"common")," for singleplayer)")," using the command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"dumpzone <target game> common_mp\n")),(0,i.kt)("p",null,'Note that a "patch" version of the common fastfile always exists (example: ',(0,i.kt)("inlineCode",{parentName:"p"},"patch_common_mp"),"), so the assets could also be there."),(0,i.kt)("p",null,"You should then move this folder from ",(0,i.kt)("inlineCode",{parentName:"p"},"dump/")," into a folder called ",(0,i.kt)("inlineCode",{parentName:"p"},"zonetool_paths")," in your target game's root directory. x64-zt will look for assets in any folder inside zonetool_paths. Alternatively, you can copy the contents of the dumped folder into the map's zonetool folder, but this is not advised as it will take a long time."),(0,i.kt)("h3",{id:"ref-red-models"},'"REF" red models'),(0,i.kt)("p",null,"The process to fix is relatively the same with images."),(0,i.kt)("h3",{id:"textures-are-blackgraywhitered"},"Textures are black/gray/white/red"),(0,i.kt)("p",null,"This probably means that zonetool failed to dump the streamed images. To check if this is the case, see if the ",(0,i.kt)("inlineCode",{parentName:"p"},"streamed_images")," folder contains .pixels files, if not then something went wrong. Most likely zonetool was unable to find the source game's image files. This should not happen."),(0,i.kt)("h3",{id:"vertex-type-x-doesnt-have-the-information-used-by-shader-y-in-material-z"},"Vertex type X doesn't have the information used by shader Y in material Z"),(0,i.kt)("p",null,"This most likely indicates you are missing that particular material, the same fix as issue #1 should apply."),(0,i.kt)("h3",{id:"bad-weaponinfo-x-specified-for-turret-it-likely-needs-to-be-precached-in-script"},"Bad weaponinfo X specified for turret. It likely needs to be precached in script."),(0,i.kt)("p",null,"This indicates that the original map includes a turret, you can either:"),(0,i.kt)("p",null,"Simply remove the turret entirely (this is advised unless you really want the turret). To do this, open the ",(0,i.kt)("inlineCode",{parentName:"p"},"<mapname>.d3dbsp.ents")," file you will find in ",(0,i.kt)("inlineCode",{parentName:"p"},"zonetool/mapname/maps/mp")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"zonetool/mapname/maps/")," and search for ",(0,i.kt)("inlineCode",{parentName:"p"},'"weaponinfo"'),". Once found, remove the entire section that includes it, example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n"bottomarc" "70"\n"rightarc" "40"\n"leftarc" "40"\n"targetname" "minigun_turret_2"\n"spawnflags" "0"\n"toparc" "10"\n"classname" "misc_turret"\n"export" "1"\n"model" "npc_minigun_turret"\n"weaponinfo" "turret_minigun_mp"\n"origin" "1004.5 -80 865"\n"angles" "0 180 0"\n}\n')),(0,i.kt)("p",null,'Everything from and including the opening bracket to the closing bracket should be removed. Repeat this for every case of "weaponinfo" in the file.'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Or")," you can add the required assets (usually just the weapon): Repeat the same process as for removing it but don't actually remove it and simply save every instance of the value of ",(0,i.kt)("inlineCode",{parentName:"p"},'"weaponinfo"'),"."),(0,i.kt)("p",null,"For example, the value of one of the weaponinfo's is ",(0,i.kt)("inlineCode",{parentName:"p"},"turret_minigun_mp"),". This just gets parsed in your CSV as:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"weapon,turret_minigun_mp\n")),(0,i.kt)("h3",{id:"animation-x-not-defined-in-anim-tree-animtree-name"},"animation 'X' not defined in anim tree '{animtree name}'"),(0,i.kt)("p",null,"This means the map is using an animation tree that is not defined on the target game. Dump the ",(0,i.kt)("inlineCode",{parentName:"p"},"{animtree name}.atr")," of the source game, which is usually found in the common fastfile ",(0,i.kt)("em",{parentName:"p"},"(refer to issue #1)"),", copy the file (including its folder: ",(0,i.kt)("inlineCode",{parentName:"p"},"animtrees/{animtree name}.atr"),") into a folder called ",(0,i.kt)("strong",{parentName:"p"},"override")," (create it if it doesn't exist) inside ",(0,i.kt)("inlineCode",{parentName:"p"},"[target game]/zonetool/mapname/"),", then include it in the csv (refer to issue #1)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"rawfile,override/animtrees/{animtree name}.atr\n")))}c.isMDXComponent=!0}}]);