"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[119],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),u=c(t),m=l,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return t?a.createElement(h,o(o({ref:n},p),{},{components:t})):a.createElement(h,o({ref:n},p))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=t.length,o=new Array(i);o[0]=u;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r.mdxType="string"==typeof e?e:l,o[1]=r;for(var c=2;c<i;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},9120:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return r},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var a=t(7462),l=t(3366),i=(t(7294),t(3905)),o=["components"],r={},s="Lua Syntax",c={unversionedId:"scripting-syntax",id:"scripting-syntax",isDocsHomePage:!1,title:"Lua Syntax",description:"Learn the syntax for Lua including basic examples and notes to help you.",source:"@site/docs/scripting-syntax.md",sourceDirName:".",slug:"/scripting-syntax",permalink:"/scripting-syntax",editUrl:"https://github.com/h1-mod/website/tree/docs/edit/docs/scripting-syntax.md",tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Loading a Lua script",permalink:"/load-script"},next:{title:"Referencing GSC and GSC dump",permalink:"/gsc-reference"}},p=[{value:"Callbacks",id:"callbacks",children:[],level:2},{value:"Types",id:"types",children:[{value:"Strings",id:"strings",children:[],level:3},{value:"Integer",id:"integer",children:[],level:3},{value:"Float",id:"float",children:[],level:3},{value:"Vector",id:"vector",children:[],level:3},{value:"Entity",id:"entity",children:[],level:3}],level:2},{value:"Events",id:"events",children:[{value:"Event Listening (waittill)",id:"event-listening-waittill",children:[],level:3},{value:"Firing (notify)",id:"firing-notify",children:[],level:3}],level:2},{value:"Timers",id:"timers",children:[],level:2},{value:"Functions",id:"functions",children:[{value:"Entity-specific functions",id:"entity-specific-functions",children:[],level:3}],level:2},{value:"Fields",id:"fields",children:[],level:2},{value:"Noteworthy information",id:"noteworthy-information",children:[],level:2},{value:"Additional client features",id:"additional-client-features",children:[{value:"Calling/hooking GSC functions",id:"callinghooking-gsc-functions",children:[],level:3},{value:"Chat notifies",id:"chat-notifies",children:[],level:3},{value:"Command execution",id:"command-execution",children:[],level:3},{value:"Player damage/killed callbacks",id:"player-damagekilled-callbacks",children:[],level:3},{value:"GSC arrays",id:"gsc-arrays",children:[],level:3},{value:"GSC structs",id:"gsc-structs",children:[],level:3},{value:"HTTP",id:"http",children:[],level:3}],level:2}],d={toc:p};function u(e){var n=e.components,t=(0,l.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"lua-syntax"},"Lua Syntax"),(0,i.kt)("p",null,"Learn the syntax for Lua including basic examples and notes to help you."),(0,i.kt)("h2",{id:"callbacks"},"Callbacks"),(0,i.kt)("p",null,"Before we show any function examples for syntax examples, you must know what a lambda and a callback is. A lambda is a function that's made when passing the argument. When doing a notify, interval, or timeout event (as shown below later), a function callback that's specified is called."),(0,i.kt)("p",null,"You can either make a function callback that uses a lambda:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'level:onnotify("connected", function(player)\n    -- [...]\nend)\n')),(0,i.kt)("p",null,"Or, you can make a function callback by calling the function seperate:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'function on_player_connected(player)\n    -- [...]\nend\n\nlevel:onnotify("connected", on_player_connected)\n')),(0,i.kt)("p",null,"Syntax examples shown as mostly lambdas, while some are seperate-called functions."),(0,i.kt)("h2",{id:"types"},"Types"),(0,i.kt)("p",null,"There are only 5 distinct types needed to interact with game's scripting environment. LUA, of course, has more types, but what is meant by this is the following:"),(0,i.kt)("p",null,"When dealing with events, functions or fields, no complex LUA types are supported, only these primitive types:"),(0,i.kt)("h3",{id:"strings"},"Strings"),(0,i.kt)("p",null,'Strings are text enclosed by quotes as so: "Hello World". There is not much to say about them, as they are a common concept.'),(0,i.kt)("h3",{id:"integer"},"Integer"),(0,i.kt)("p",null,"Integers are all whole numbers like 0, 1000 or -15.\nBoolean values, so true and false, also fall under that category and are handled as 1 and 0 respectively."),(0,i.kt)("h3",{id:"float"},"Float"),(0,i.kt)("p",null,"Floating point values are all numbers like 1.05 or -10.5.\n1.0 is also a floating point number literal. This is due to the dot notation, even though it's technically a whole number."),(0,i.kt)("h3",{id:"vector"},"Vector"),(0,i.kt)("p",null,"A vector is a type that groups exactly 3 floating point components. It is used to represent coordinates, angles or colors in the game."),(0,i.kt)("p",null,"Creating a new vector can be done like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"local my_vector = vector:new(1.0, 2.0, 3.0)\n\n-- Statements below will be true\nassert(my_vector.x == 1.0)\nassert(my_vector.y == 2.0)\nassert(my_vector.z == 3.0)\n")),(0,i.kt)("p",null,"You can access the individual components using either ",(0,i.kt)("inlineCode",{parentName:"p"},"x"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"y"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"z")," property accessors, or ",(0,i.kt)("inlineCode",{parentName:"p"},"r"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"g")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"b")," (note that both notations are equivalent, meaning ",(0,i.kt)("inlineCode",{parentName:"p"},"x")," \u2258 ",(0,i.kt)("inlineCode",{parentName:"p"},"r"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"y")," \u2258 ",(0,i.kt)("inlineCode",{parentName:"p"},"g")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"z")," \u2258 ",(0,i.kt)("inlineCode",{parentName:"p"},"b"),")."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"local my_vector = vector:new() -- vector is initialized as (0.0, 0.0, 0.0)\nmy_vector.x = 5.0\nmy_vector.y = 1.0\nmy_vector.z = 2.0\n\nlocal val1 = my_vector.x -- val1 is 5.0\nlocal val2 = my_vector.r -- val2 is also 5.0, as x and r are equivalent\n\n-- The statements below are always true\nassert(my_vector.y == my_vector.g)\nassert(my_vector.z == my_vector.b)\n")),(0,i.kt)("h3",{id:"entity"},"Entity"),(0,i.kt)("p",null,"Entities represent 'things' that 'exist' in the game. Players are for example entities.\nVehicles, hud elements, or the level are also entites. They can fire events, but also call functions into the game's scripting environment. Some entites also have certain fields (or properties), like an origin or a name."),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("p",null,"Entites can fire notify events. The concept was previously known as ",(0,i.kt)("inlineCode",{parentName:"p"},"notify")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"waittill")," in GSC.\nPopular events are the ",(0,i.kt)("inlineCode",{parentName:"p"},"connected")," event fired by the level, or the ",(0,i.kt)("inlineCode",{parentName:"p"},"spawned_player")," event fired by players."),(0,i.kt)("h3",{id:"event-listening-waittill"},"Event Listening (waittill)"),(0,i.kt)("p",null,"You can listen to any of these events by calling either ",(0,i.kt)("inlineCode",{parentName:"p"},"onnotify")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"onnotifyonce")," on an entity:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'level:onnotify("connected", function(player)\n    -- [...]\nend)\n')),(0,i.kt)("p",null,"In the example above, the ",(0,i.kt)("inlineCode",{parentName:"p"},"player_connected")," callback is called every time a player connects. If you don't want to be notified every time, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},"onnotifyonce")," instead, which only fires once."),(0,i.kt)("p",null,"If you called ",(0,i.kt)("inlineCode",{parentName:"p"},"onnotify")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"onnotifyonce"),"), but want to stop listening for notifications, you can call clear on the object is returned:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'-- [...]\n\nlocal listener = level:onnotify("connected", function(player)\n    -- [...]\nend)\n\n-- [...]\n\nlistener:clear() -- stops listening for the `connected` event\n')),(0,i.kt)("p",null,"Events can carry arguments. For example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"connected")," event by the level carries the connecting ",(0,i.kt)("inlineCode",{parentName:"p"},"player")," as an argument. You can get these arguments by adding paramters to the callback functions, as seen in the player_connected callback above."),(0,i.kt)("h3",{id:"firing-notify"},"Firing (notify)"),(0,i.kt)("p",null,"To fire (or notify) a event, you can call the ",(0,i.kt)("inlineCode",{parentName:"p"},"notify")," function on an entity:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'-- this callback function is called by the "connected" event\nfunction entity:connected()\n    self:onnotify("hello_world", function()\n        print("Callback was recieved for hello_world notify")\n    end)\n\n    -- [...]\n\n    self:notify("hello_world")\nend\n')),(0,i.kt)("p",null,"Don't forget - you can also pass arguments to the event (there can be any amount, but they must be instances of one of the 5 primitive ",(0,i.kt)("a",{parentName:"p",href:"#types"},"types"),"):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'-- this callback function is called by the "connected" event\nfunction entity:connected()\n    self:onnotify("hello_world", function(str1, str2)\n        print("Callback was recieved for hello_world notify: " .. str1 " " .. str2)\n    end)\n\n    -- [...]\n\n    self:notify("hello_world", "Hello", "World")\nend\n')),(0,i.kt)("h2",{id:"timers"},"Timers"),(0,i.kt)("p",null,"Timers are required to delay the execution. GSC had a function called ",(0,i.kt)("inlineCode",{parentName:"p"},"wait"),", which paused the execution of a thread for a specific amount of time. Due to the control flow being different in LUA, there are neither threads, nor is there a wait function."),(0,i.kt)("p",null,"However, you can do something else to delay the execution. The functions ",(0,i.kt)("inlineCode",{parentName:"p"},"ontimeout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"oninterval"),", which need to be called on the game object, allow to do that. They take two arguments, a callback and a time to wait in milliseconds."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"game:ontimeout(function()\n    -- [...]\nend, 1000)\n")),(0,i.kt)("p",null,"Similar to the functions ",(0,i.kt)("inlineCode",{parentName:"p"},"setTimeout")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"setInterval")," known from JavaScript, ",(0,i.kt)("inlineCode",{parentName:"p"},"ontimeout")," executes the callback exactly once when the delay is reached and ",(0,i.kt)("inlineCode",{parentName:"p"},"oninterval")," executes it every time the specified amount of time passes."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"local timer = game:ontimeout(function()\n    -- [...]\nend, 1000)\n\n-- [...]\n\ntimer:clear()\n")),(0,i.kt)("p",null,"Timer callbacks don't and shouldn't take any arguments. If you want to pass an object, like a player, to a callback, you have to capture it, in a lambda for example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'function entity:do_something_cool()\n    print(self.name .. " is now doing something cool.")\n    -- [...]\nend\n\n-- [...]\n\nlocal player = -- [...]\ngame:oninterval(function()\n    player:do_something_cool()\nend, 1000)\n')),(0,i.kt)("h2",{id:"functions"},"Functions"),(0,i.kt)("p",null,"The game provides a set of global functions and entity methods. The functions provided are pretty much the same as COD4 had them, or any other game that uses GSC. Since this game is heavily based off IW6 (Ghosts) engine and is very very similar, most of the GSC used in IW6 and S1 (Advanced Warfare) is the same."),(0,i.kt)("p",null,"You can use a community-made ",(0,i.kt)("a",{parentName:"p",href:"https://znation.nl/cod4script/"},"COD4 Scripting Reference")," website to find some functions (libcod does not exist in stock GSC nor H1-Mod). Any functions, methods, or tokens should be all lowercase."),(0,i.kt)("p",null,"Global functions are functions that don't need an entity to run. They are called on the ",(0,i.kt)("inlineCode",{parentName:"p"},"game")," object (ex: ",(0,i.kt)("inlineCode",{parentName:"p"},"game:isplayer(player)"),"). When referring to the COD4 Scripting Reference, these functions won't have have a ",(0,i.kt)("inlineCode",{parentName:"p"},"Call this on:")," tab."),(0,i.kt)("p",null,"Example of a global function:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'local player = -- [...]\nif game:isplayer(player) == 1 then\n    print(player.name .. " is a player")\nend\n')),(0,i.kt)("p",null,"There are also member functions. These will have a ",(0,i.kt)("inlineCode",{parentName:"p"},"Call this on:")," tab on the COD4 Scripting Reference. Example of a member function:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"local player = -- [...]\nplayer:freezecontrols(false)\n")),(0,i.kt)("p",null,"For a list of all functions, methods, and tokens available in H1-Mod, have a look at the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/h1-mod/h1-mod/blob/develop/src/client/game/scripting/function_tables.cpp"},"function, method, and token tables"),"."),(0,i.kt)("h3",{id:"entity-specific-functions"},"Entity-specific functions"),(0,i.kt)("p",null,"Functions defined with an ",(0,i.kt)("inlineCode",{parentName:"p"},"entity:")," prefix give the function the ability to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"self")," keyword, similar to GSC."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'-- entity: prefix defined, makes this function only available to be called on entities\nfunction entity:connected()\n    print("Player " .. self.name .. " connected")\nend\n\nlevel:onnotify("connected", function(player)\n    player:connected()\nend)\n')),(0,i.kt)("p",null,"Syntax examples shown are mostly using entity-defined functions. The alternative to not defining the ",(0,i.kt)("inlineCode",{parentName:"p"},"entity:")," prefix would be passing the player through like normal (as shown in ",(0,i.kt)("a",{parentName:"p",href:"#callbacks"},"callbacks"),")."),(0,i.kt)("h2",{id:"fields"},"Fields"),(0,i.kt)("p",null,"Entities do have fields (or properties). They differ for each type of entity. For example, players have fields like ",(0,i.kt)("inlineCode",{parentName:"p"},"name"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"origin"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"angles")," and hud elements have fields like ",(0,i.kt)("inlineCode",{parentName:"p"},"x"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"y"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"alpha"),"."),(0,i.kt)("p",null,"You can get and set them like this (only the 5 primitive types are supported):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"local player_name = player.name\nplayer.origin = vector:new()\n")),(0,i.kt)("p",null,"There is no complete list of which fields exist. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"level.players")," is not a field and is a variable. Not every field from GSC is available in LUA and may also have a definition of ",(0,i.kt)("inlineCode",{parentName:"p"},"_ID<decimal>")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"_id_<hex>"),", which you can find in the tutorial for finding variable/field IDs later."),(0,i.kt)("h2",{id:"noteworthy-information"},"Noteworthy information"),(0,i.kt)("p",null,"Players can disconnect. It might sound obvious, but is important for scripting. Executing functions on a player that doesn't exist won't work. Additionally, captured player objects need to be freed."),(0,i.kt)("p",null,"GSC used to have a function called ",(0,i.kt)("inlineCode",{parentName:"p"},"endon"),", which allowed to terminate a thread as soon as an event happend. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},'player endon("disconnect")')," stopped the execution of a thread when a player disconnected."),(0,i.kt)("p",null,"Back when IW6x had just released Lua scripting, the ",(0,i.kt)("inlineCode",{parentName:"p"},"endon")," functionality did not exist. Later in IW6x, S1x, and now H1-Mod, the ",(0,i.kt)("inlineCode",{parentName:"p"},"endon")," functionality has been implemented like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'function entity:do_something_cool()\n    print(self.name .. " is now doing something cool.")\n    -- [...]\nend\n\n-- [...]\n\nlocal player = -- [...]\nlocal timer = game:oninterval(function()\n    player:do_something_cool()\nend, 1000)\n\n-- the interval timer loop will stop running when the `disconnect` event is called on the player\ntimer:endon(player, "disconnect")\n')),(0,i.kt)("h2",{id:"additional-client-features"},"Additional client features"),(0,i.kt)("p",null,"Because there is a custom Lua scripting API, there are some custom stuff that come from us that assist in development and make stuff easier to work with."),(0,i.kt)("h3",{id:"callinghooking-gsc-functions"},"Calling/hooking GSC functions"),(0,i.kt)("p",null,"Refer to ",(0,i.kt)("a",{parentName:"p",href:"/gsc-reference"},"GSC Reference")," to figure out how to do this. This also contains including files from GSC and calling function variables."),(0,i.kt)("h3",{id:"chat-notifies"},"Chat notifies"),(0,i.kt)("p",null,"When a player sends a chat, you are able to grab that in Lua. All you need to do is monitor the ",(0,i.kt)("inlineCode",{parentName:"p"},"say")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"say_team"),") notify. The optional ",(0,i.kt)("inlineCode",{parentName:"p"},"hidden")," parameter is only true when the player's chat message starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"/"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'level:onnotify("say", function(player, message, hidden)\n    print(player.name .. ": " .. message)\nend)\n')),(0,i.kt)("p",null,"You can also monitor the notify on a specific player."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'level:onnotify("connected", function(player)\n    player:onnotify("say", function(message, hidden)\n        print(player.name .. ": " .. message)\n    end)\nend)\n')),(0,i.kt)("h3",{id:"command-execution"},"Command execution"),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"game:executecommand")," function from the game object like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'game:executecommand("map mp_crash")\n')),(0,i.kt)("h3",{id:"player-damagekilled-callbacks"},"Player damage/killed callbacks"),(0,i.kt)("p",null,"Callbacks can be added using the ",(0,i.kt)("inlineCode",{parentName:"p"},"game:onplayerkilled")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"game:onplayerdamage")," functions from the game object. The only data you can modify from this is the damage. Returning anything other than a number (msut be an integer) will not do anything."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'game:onplayerdamage(function(_self, inflictor, attacker, damage, dflags, mod, weapon, point, dir, hitloc)\n    damage = 0\n    return damage\nend)\n\ngame:onplayerkilled(function(_self, inflictor, attacker, damage, mod, weapon, dir, hitloc, timeoffset, deathanimduration)\n    print(attacker.name .. " killed " .. _self.name)\nend)\n')),(0,i.kt)("h3",{id:"gsc-arrays"},"GSC arrays"),(0,i.kt)("p",null,"GSC arrays are supported and can be accessed similarly to GSC:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'local players = game:getentarray("player", "classname")\nfor i = 1, #players do\n    local player = players[i]\n    print("Index " .. i .. ": Player is " .. player.name)\nend\n')),(0,i.kt)("h3",{id:"gsc-structs"},"GSC structs"),(0,i.kt)("p",null,"GSC structs are also supported similarly as the arrays. To get an entity's struct, you can directly access the property."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"-- old way\nlocal grace_period = level:getstruct().ingraceperiod\n\n-- new way\nlocal grace_period = level.ingraceperiod\n")),(0,i.kt)("h3",{id:"http"},"HTTP"),(0,i.kt)("p",null,"HTTP functions can be accessed from the global ",(0,i.kt)("inlineCode",{parentName:"p"},"http")," table."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"http.request(url[, options[, async]])"),": Returns a table, you can replace the request's callbacks (",(0,i.kt)("inlineCode",{parentName:"p"},"onprogress"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"onerror"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"onload"),") with your own and send the request using the ",(0,i.kt)("inlineCode",{parentName:"p"},".send")," method."),(0,i.kt)("p",{parentName:"li"},"The second parameter is the options table, which should contain two other tables for the headers and parameters for POST requests."),(0,i.kt)("p",{parentName:"li"},"The async parameter specifies wheter the request will be executed on the server thread or on a async thread. If you choose to execute it asynchronously then inside the callbacks you must wrap any calls to game functions with ",(0,i.kt)("inlineCode",{parentName:"p"},"game:ontimeout")," in order to call them from the correct thread."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'local request = http.request("https://example.com", {\n    headers = {\n        ["Content-type"] = "text/html"\n    },\n    parameters = {\n        foo = "bar"\n    }\n}, true)\n\nrequest.onprogress = function(progress)\n    print(progress)\nend\n\nrequest.onerror = function(error, code)\n    print(error, code)\nend\n\n-- Request is done\nrequest.onload = function(data)\n    print(data)\n    \n    game:ontimeout(function()\n        game:iprintln("Done!")\n    end, 0)\nend\n \nrequest.send()\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"http.get(url, callback[, async])"),": This function is simpler than ",(0,i.kt)("inlineCode",{parentName:"p"},"http.request")," and only takes the url and callback as parameters (and eventually the async parameter)."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'http.get("https://example.com", function(data)\n    print(data)\nend, true)\n')))))}u.isMDXComponent=!0}}]);