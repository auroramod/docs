"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[990],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return c}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),d=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=d(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=d(t),c=i,h=m["".concat(s,".").concat(c)]||m[c]||u[c]||l;return t?a.createElement(h,r(r({ref:n},p),{},{components:t})):a.createElement(h,r({ref:n},p))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=t.length,r=new Array(l);r[0]=m;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var d=2;d<l;d++)r[d]=t[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},5290:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return p},toc:function(){return u},default:function(){return h}});var a,i=t(7462),l=t(3366),r=(t(7294),t(3905)),o=["components"],s={},d="GSC syntax & debugging",p={unversionedId:"gsc-scripting-syntax",id:"gsc-scripting-syntax",isDocsHomePage:!1,title:"GSC syntax & debugging",description:"Learn the syntax for GSC including basic examples and notes to help you.",source:"@site/docs/gsc-scripting-syntax.md",sourceDirName:".",slug:"/gsc-scripting-syntax",permalink:"/gsc-scripting-syntax",editUrl:"https://github.com/h1-mod/docs/blob/main/docs/gsc-scripting-syntax.md",tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Loading a GSC script",permalink:"/gsc-load-script"},next:{title:"GSC dumps",permalink:"/gsc-dump"}},u=[{value:"Comments",id:"comments",children:[],level:2},{value:"Function Declaration",id:"function-declaration",children:[],level:2},{value:"Calling functions",id:"calling-functions",children:[],level:2},{value:"Using variables",id:"using-variables",children:[{value:"<code>while</code>",id:"while",children:[],level:3},{value:"<code>for</code>",id:"for",children:[],level:3},{value:"<code>foreach</code>",id:"foreach",children:[],level:3}],level:2},{value:"Wait",id:"wait",children:[],level:2},{value:"Switch",id:"switch",children:[],level:2},{value:"Events",id:"events",children:[{value:"notify",id:"notify",children:[],level:3},{value:"endon",id:"endon",children:[],level:3},{value:"waittill",id:"waittill",children:[],level:3}],level:2},{value:"Custom functions",id:"custom-functions",children:[{value:"Misc",id:"misc",children:[],level:3},{value:"IO",id:"io",children:[],level:3},{value:"JSON",id:"json",children:[],level:3},{value:"Debugging",id:"debugging",children:[],level:3}],level:2},{value:"Script errors",id:"script-errors",children:[{value:"Opcodes",id:"opcodes",children:[],level:3},{value:"Variable leaks",id:"variable-leaks",children:[],level:3}],level:2}],m=(a="Details",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)}),c={toc:u};function h(e){var n=e.components,a=(0,l.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"gsc-syntax--debugging"},"GSC syntax & debugging"),(0,r.kt)("p",null,"Learn the syntax for GSC including basic examples and notes to help you."),(0,r.kt)("h2",{id:"comments"},"Comments"),(0,r.kt)("p",null,"Comments exist in two ways, one-line, or multi-line block comments."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"// This is a one-line comment.\n\n/*\nThis is a comment across\nmultiple lines!\n*/\n")),(0,r.kt)("h2",{id:"function-declaration"},"Function Declaration"),(0,r.kt)("p",null,"Declaring functions in GSC require you to give it a name, followed by a () and a bracket scope."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"my_function()\n{   // start of bracket scope\n    // [...]\n}   // end of bracket scope\n")),(0,r.kt)("h2",{id:"calling-functions"},"Calling functions"),(0,r.kt)("p",null,'GSC functions can be "threaded" or called sequentially (in logical order/sequence). If a function is "threaded", then the execution of the function being called will not hold the execution of the parent function that contains the call.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'my_function()\n{\n    print("my_other_function execution starting");\n    my_other_function(); // my_function() will not continue past this line until the execution of my_other_function() finishes\n    print("my_other_function execution completed");\n\n    print("my_other_function thread execution starting");\n    thread my_other_function(); // my_function() will continue past this line and carry on doing other stuff\n    print("my_other_function thread execution still continuing, but it\'s threaded");\n}\n\nmy_other_function()\n{\n    wait 3; // this function executes a 3 second wait\n    print("3 seconds waited");\n}\n\n/*\n"my_other_function execution starting"\n"3 seconds waited"\n"my_other_function execution completed"\n"my_other_function thread execution starting"\n"my_other_function thread execution still continuing, but it\'s threaded"\n"3 seconds waited"\n*/\n')),(0,r.kt)("p",null,"If you call a function on an entity, the ",(0,r.kt)("inlineCode",{parentName:"p"},"self")," keyword is reversed as the entity who called the function"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'my_function()\n{\n    getplayers()[0] hello_world(); // index 0 will get the first player in the game\n}\n\nhello_world() // self == player\n{\n    self iprintln("hello world!");\n}\n')),(0,r.kt)("h2",{id:"using-variables"},"Using variables"),(0,r.kt)("p",null,"Variables are used to store data for the span of the current game. Variables will reset upon map rotation unless stored outside of the GSC VM context. However, for round-based gamemodes, persistent variables will keep the data through restarts."),(0,r.kt)("p",null,"A local variable is a variable that can be used in the whole function scope it's defined in. A variable can b e used to call a function or passed to a function via parameters. Defining a local variable is as easy as:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"variable = 1;\n")),(0,r.kt)("p",null,"Variables can also be global:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"level.variable = 1;\n")),(0,r.kt)("p",null,"or defined on an object (or entity) and be passed through to functions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'my_function()\n{\n    variable = spawnstruct();\n    variable.message = "hi!";\n\n    variable print_message();\n}\n\nprint_message() // self == variable\n{\n    print(self.message);\n}\n\n/*\n"hi!"\n*/\n')),(0,r.kt)("h1",{id:"math"},"Math"),(0,r.kt)("p",null,"Math can play a huge part in gameplay scripting depending on what you are doing. The operators you can use for math in GSC include the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"+       Addition\n-       Subtraction\n*       Multiplication\n/       Division\n%       Modulus (Remainder)\n=       Equals\n++      Increment (+1)\n--      Decrement (-1)\n+=      Incrementation (requires number)\n-=      Decrementation (requires number)\n")),(0,r.kt)("p",null,"Example some of the operations:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"var++;\nvar--;\nvar += int;\nvar -= int;\n")),(0,r.kt)(m,{title:"Bitwise Information",mdxType:"Details"},(0,r.kt)("p",null,"You can also use ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Bitwise_operation"},"Bitwise (Wikipedia)")," operations in GSC."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"&       Bitwise And\n|       Bitwise Or (inclusive or)\n^       Bitwise Xor (exclusive or)\n<<      Left Shift\n>>      Right Shift\n~       Bitwise NOT (one's complement)\n"))),(0,r.kt)("h1",{id:"if-statements"},"If statements"),(0,r.kt)("p",null,"An 'if' statement is used to see if a condition is met, and then execute code (delared in a scope) as the result. The operators you can use for comparing data in GSC include the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"==      Equal To\n!=      Not Equal To\n!       Negation (Not equal to)\n<       Less than\n>       Greater than\n<=      Less or Equal to\n>=      Greater or Equal to\n&&      And\n||      Or\n")),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'if (9 > 10)\n{\n    print("9 is above 10");\n}\nelse\n{\n    print("9 is below 10");\n}\n\n/*\n"9 is below 10"\n*/\n')),(0,r.kt)("p",null,"You can also do if statements on ",(0,r.kt)("b",null,"any")," sort of variables"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'message = "hi!";\n\nif (message == "hi!")\n{\n    print("hello variable!");\n}\nelse\n{\n    print("variable didn\'t say hi? :(");\n}\n\n/*\n"hello variable!"\n*/\n')),(0,r.kt)("p",null,'The conditions can also have a "else if" to check multiple conditions'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'big_number = 100;\n\nif (big_number < 20)\n{\n    print("big number is below the number 20");\n}\nelse if (big_number < 150)\n{\n    print("big number is below the number 150");\n}\nelse\n{\n    print("big number is above the number 150");\n}\n\n/*\n"big number is below the number 150"\n*/\n')),(0,r.kt)("p",null,"In GSC, you can check if a variable is defined with a value. This is because if a variable was undefined, and you check if it's true, it'll invoke on the condition. To do this, use the function ",(0,r.kt)("inlineCode",{parentName:"p"},"isdefined(var)"),", which returns ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"false"),". If a variable equals keyword ",(0,r.kt)("inlineCode",{parentName:"p"},"undefined")," or isn't defined at all, you should get ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," as the return type."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'variable_one = 5;\nvariable_two = 6;\n\nif (isdefined(variable_one))\n{\n    print("variable_one is defined!");\n    variable_two = undefined; // undefined is a reserved keyword\n}\n\nif (variable_two) // the variable is undefined, but it\'ll still think this condition as met\n{\n    print("variable_two claimed to be true, but is it defined?");\n    if (isdefined(variable_two))\n    {\n        print("is not defined");\n    }\n    else\n    {\n        print("is defined");\n    }\n}\n\n/*\n"variable_one is defined!"\n"variable_two claimed to be true, but is it defined?"\n"is not defined"\n*/\n')),(0,r.kt)("p",null,"This is why the GSC scripts will check if a variable ",(0,r.kt)("inlineCode",{parentName:"p"},"isdefined")," before checking if it is ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'if (isdefined(variable_two) && variable_two)\n{\n    print("variable_two is defined and is true");\n}\n\n/*\n"variable_two is defined and is true"\n*/\n')),(0,r.kt)("p",null,"In GSC, the ternary operator is also supported."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'condition = (5 > 2) ? true : false;\nprint(condition);\n\n/*\n"true"\n*/\n')),(0,r.kt)("h1",{id:"loops"},"Loops"),(0,r.kt)("p",null,"Loops in GSC can be somewhat similar to C, but may come in different forms."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("inlineCode",{parentName:"li"},"while")," loop is a loop that will keep looping while the condition provided is true"),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("inlineCode",{parentName:"li"},"for")," loop is a loop that loops a set amount of times"),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("inlineCode",{parentName:"li"},"foreach")," loop is a simplified ",(0,r.kt)("inlineCode",{parentName:"li"},"for")," loop meant to be used on all items of an array.")),(0,r.kt)("h3",{id:"while"},(0,r.kt)("inlineCode",{parentName:"h3"},"while")),(0,r.kt)("p",null,"In this example, we will check if number X is above 10."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'x = 0;\nwhile (x < 6)\n{\n    print(va("x = %s", x));\n    number++;\n}\n\nprint("while loop condition was met");\n\n/*\n"x = 0"\n"x = 1"\n"x = 2"\n"x = 3"\n"x = 4"\n"x = 5"\n"x = 6"\n"while loop condition was met\n*/\n')),(0,r.kt)("h3",{id:"for"},(0,r.kt)("inlineCode",{parentName:"h3"},"for")),(0,r.kt)("p",null,"In this example, we will create an infinite loop that will never end."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'my_function()\n{\n    thread infinite_loop(); // make sure the loop you are doing doesn\'t halt the parent function\n}\n\ninfinite_loop()\n{\n    for(;;)\n    {\n        print("infinite loop");\n        wait 0.05; // infinite loops NEED to wait a server frame else your script will lag terribly or your game will crash.\n    }\n}\n')),(0,r.kt)("h3",{id:"foreach"},(0,r.kt)("inlineCode",{parentName:"h3"},"foreach")),(0,r.kt)("p",null,"In this example, we will create a loop that prints every single player in the game's name."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'foreach (player in getplayers())\n{\n    print(va("player: %s", player.name));\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"for")," loop equivalent to this would be:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'players = getplayers();\nfor (i = 0; i < players.size; i++)\n{\n    print(va("player %s: %s", i, players[i].name));\n}\n')),(0,r.kt)("h2",{id:"wait"},"Wait"),(0,r.kt)("p",null,"GSC is ran on every server frame, and 20 server frames equal to 1 second."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"wait 0.05;  // 1 server frame\nwait 0.5;   // 10 server frames\nwait 1;     // 20 server frames\nwait (1);   // 20 server frames\n")),(0,r.kt)("h2",{id:"switch"},"Switch"),(0,r.kt)("p",null,"Switch cases are useful for checking the case of many possibly values. This is usually recommended if you are have more than 4-5 variables as it may be faster and more organized compared to a ",(0,r.kt)("inlineCode",{parentName:"p"},"if")," statement."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'value = 5;\nswitch (value)\n{\n    case 1:\n        print("value is 1");\n        break;\n    case 2:\n        print("value is 2");\n        break;\n    case 3:\n        print("value is 3");\n        break;\n    case 4:\n        print("value is 4");\n        break;\n    case 5:\n        print("value is 5");\n        break;\n    default:\n        print("value is not any of the cases listed");\n        break;\n}\n')),(0,r.kt)("h2",{id:"events"},"Events"),(0,r.kt)("h3",{id:"notify"},"notify"),(0,r.kt)("p",null,"A notify event will send a cue to a endon or waittill to do something. When you notify something, it is called like ",(0,r.kt)("inlineCode",{parentName:"p"},'<entity> notify("my_cool_notify")'),"."),(0,r.kt)("h3",{id:"endon"},"endon"),(0,r.kt)("p",null,"Knowing how a notify works, you can end threads you create easily. One of the most common notifies that occur is when a player disconnects from the game, which should be used in any player thread you run."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'my_cool_player_func() // self == player\n{\n    self endon("disconnect");   // ends when player disconnects\n    level endon("game_ended");  // ends when level ends game\n\n    for(;;)\n    {\n        print(va("player %s has %s kills!", self.name, self.kills));\n        wait 5;\n    }\n}\n')),(0,r.kt)("h3",{id:"waittill"},"waittill"),(0,r.kt)("p",null,"A notify can also execute a waittill. A waittill is something that waits for a event to be notified, and then you can execute code off of it. If you run a waittill that isn't in a ",(0,r.kt)("inlineCode",{parentName:"p"},"for")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"while"),", you ",(0,r.kt)("b",null,"still need a endon")," because the thread will never end or cause undefined behavior if so."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'on_player_connect() // self == level\n{\n    level endon("game_ended");  // ends when level ends game\n\n    for(;;)\n    {\n        level waittill("connected", player); // this is called every time a player connects\n        print(va("player %s has connected!", player.name));\n    }\n}\n')),(0,r.kt)("p",null,"TODO"),(0,r.kt)("h2",{id:"custom-functions"},"Custom functions"),(0,r.kt)("p",null,"With H1-mod, we add a variety of custom GSC functions and methods that are unique to the client and can assist in GSC. Below are most of the functions documented for usage."),(0,r.kt)("h3",{id:"misc"},"Misc"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"print(message)"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"println(message)"),": Prints a message to the console.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"logprint(message)"),": Prints a message to the game log.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"toupper(string)"),": Converts all of a string to uppercase.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"executecommand(command)"),": Executes a console command.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"replaceFunc(with, what)"),": Replaces a script function with another script function."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'main()\n{\n    replacefunc(maps\\mp\\gametypes\\_callbacksetup::callbackVoid, ::callbackvoid_override);\n}\n\ncallbackvoid_override()\n{\n    print("callback void override was called");\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"getFunction(filename, name)"),": Gets a function from a GSC script."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    function = getFunction("maps/mp/gametypes/_callbacksetup", "callbackVoid");\n    [[ function ]]();\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"getFunctionName(function)"),": Returns the function's name."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    function = getFunction("maps/mp/gametypes/_callbacksetup", "callbackVoid");\n    print(getFunctionName(function)); // "maps/mp/gametypes/_callbacksetup::callbackVoid"\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"say(message)"),": Sends a chat message to all players."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'onPlayerConnected()\n{\n    while (true)\n    {\n        level waittill("connected", player);\n        say(player.name + " connected!");\n    }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"entity tell(message)"),": Sends a chat message to a player."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'onPlayerConnected()\n{\n    while (true)\n    {\n        level waittill("connected", player);\n        player tell("Welcome back " + player.name + "!");\n    }\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"va(string, ...)"),": Format arguments via a format string."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    server_owner = "mikey";\n    server_name = "Epic Server";\n    va_string = va("Welcome to %s\'s %s!", server_owner, server_name);\n    print(va_string); // "Welcome to mikey\'s Epic Server!"\n}\n')))),(0,r.kt)("h3",{id:"io"},"IO"),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"IO in GSC, by default, is only used when the ",(0,r.kt)("inlineCode",{parentName:"p"},"fs_game")," dvar is applied to a valid directory within the game. When the ",(0,r.kt)("inlineCode",{parentName:"p"},"fs_game")," dvar is defined, IO is locked into that directory and cannot leave that directory."),(0,r.kt)("p",{parentName:"div"},"However, you can opt-in to allow IO in GSC to use your root game directory folder instead. To do so, launch the game with the ",(0,r.kt)("inlineCode",{parentName:"p"},"-allow_root_io")," command line argument. We DO NOT recommend using this flag or enabling it for 3rd-party mods."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fileExists(path)"),": Returns true if the file exists."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"writeFile(path, data[, append])"),": Creates a file if it doesn't exist and writes/appends text to it."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"readFile(path)"),": Reads a file."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fileSize(path)"),": Returns file size in bytes."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"createDirectory(path)"),": Creates a directory."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"directoryExists(path)"),": Returns true if the directory exists."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"directoryIsEmpty(path)"),": Returns true if the directory is empty."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"listFiles(path)"),": Returns the list of files in the directory as an array."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"copyFolder(source, target)"),": Copies a folder."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"removeFile(path)"),": Deletes a file if it exists.")),(0,r.kt)("h3",{id:"json"},"JSON"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"jsonSerialize(variable[, indent])"),": Converts GSC variables (such as arrays) into JSON."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},"init()\n{\n    array = [];\n    array[0] = 1;\n    array[1] = 2;\n    json = jsonSerialize(array, 4);\n\n    print(json);\n\n    /*\n    [\n        2,\n        1\n    ]\n    */\n}\n")),(0,r.kt)("p",{parentName:"li"},"  This function can also be useful to reveal contents of existing arrays such as ",(0,r.kt)("inlineCode",{parentName:"p"},"game"),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    print(jsonSerialize(game["round_end"]), 4);\n\n    /*\n    {\n        "draw": 1,\n        "round_draw": 2,\n        "round_win": 3,\n        "round_loss": 4,\n        "victory": 5,\n        "defeat": 6,\n        "halftime": 7,\n        "overtime": 8,\n        "roundend": 9,\n        "intermission": 10,\n        "side_switch": 11,\n        "match_bonus": 12,\n        "tie": 13,\n        "game_end": 14,\n        "spectator": 15,\n    }\n    */\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"jsonParse(json)"),": Converts JSON into a GSC variable."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    array = jsonParse("[1, 2, 3, 4]");\n    print(array[0] + " " + array[1] + " " + array[2] + " " + array[3]);\n\n    /*\n    1 2 3 4\n    */\n}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"jsonPrint(...)"),": Prints values as json.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"map(...)"),": Creates a string-indexed array."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-c"},'init()\n{\n    array = map("first", 1, "second", 2);\n    print(jsonSerialize(array, 4));\n    /*\n    {\n        "first": 1,\n        "second": 2\n    }\n    */\n}\n')))),(0,r.kt)("h3",{id:"debugging"},"Debugging"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"assert(condition)"),":")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"assertex(condition, error)"),": Throws an error if condition is false. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"type(variable)"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"typeof(variable)"),": Returns the name of the type of variable."))),(0,r.kt)("h2",{id:"script-errors"},"Script errors"),(0,r.kt)("p",null,"GSC is a scripting language that is prone to errors very easily. When undefined behavior occurs, it'll just keep going the best it can. For example, when a variable is undefined but used in a if statement, it'll run the code as if the variable was true. This runtime error below shows the instruction that is failing, and then the function & file."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"runtime error example",src:t(8391).Z})),(0,r.kt)("p",null,"For some reason, it's not showing the name & function it's erroring in while I write this up, but the line information is correct and we can break it down from there.\nSo using the information, we can conclude the variable at line 50 is undefined."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"runtime error code",src:t(9712).Z})),(0,r.kt)("p",null,"Stuff like this makes people think their mod is working because they don't get runtime errors normally, but in reality, it's just working by luck. In H1-Mod, we restore a dvar known as ",(0,r.kt)("inlineCode",{parentName:"p"},"developer_script"),". When you set this dvar to ",(0,r.kt)("b",null,"1"),", and start or ",(0,r.kt)("inlineCode",{parentName:"p"},"map_restart")," a game, you will get debug information about the script including runtime errors that'll show errors in your script."),(0,r.kt)("h3",{id:"opcodes"},"Opcodes"),(0,r.kt)("p",null,"Some of the opcode instructions that show might be confusing, but they're usually straightforward. Below is a list of very common opcodes and how to fix them. The common theme between all of these is that a variable being checked is undefined, therefore needs a definition somewhere or you need logic to check if ",(0,r.kt)("inlineCode",{parentName:"p"},"isdefined")," before you do stuff with it."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Opcode"),(0,r.kt)("th",{parentName:"tr",align:null},"Reason"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_EvalSelfFieldVariable"),(0,r.kt)("td",{parentName:"tr",align:null},"Trying to access a field like self.",(0,r.kt)("b",null,"bruh")," that might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_SetLevelFieldVariableField"),(0,r.kt)("td",{parentName:"tr",align:null},"Trying to set a field on the ",(0,r.kt)("b",null,"level")," object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_CastBool"),(0,r.kt)("td",{parentName:"tr",align:null},"A variable being casted to bool is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_JumpOnFalse"),(0,r.kt)("td",{parentName:"tr",align:null},"If condition failing, usually commonly a undefined variable.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_JumpOnTrue"),(0,r.kt)("td",{parentName:"tr",align:null},"Same as OP_JumpOnFalse")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_ScriptMethodThreadCallPointer"),(0,r.kt)("td",{parentName:"tr",align:null},"Most common reason is the caller is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_CallBuiltinMethod"),(0,r.kt)("td",{parentName:"tr",align:null},"A builtin engine method is failing due to bad parameters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_inequality"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"!=")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_equality"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"==")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_greater"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},">")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_greater_equal"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},">=")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_less"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"<")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_less_equal"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"<=")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_inc"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"variable += 1")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"variable++")," is failing, meaning the variable is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_plus"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"+")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_divide"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"/")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_multiply"),(0,r.kt)("td",{parentName:"tr",align:null},"A ",(0,r.kt)("inlineCode",{parentName:"td"},"*")," is failing, meaning one or both of the variables might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_GetSelfObject"),(0,r.kt)("td",{parentName:"tr",align:null},"Self is undefined, this should never happen")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_SetVariableField"),(0,r.kt)("td",{parentName:"tr",align:null},"Setting a field on a variable that's not a entity is failing. Variable may be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_endon"),(0,r.kt)("td",{parentName:"tr",align:null},"Variable being used on a ",(0,r.kt)("inlineCode",{parentName:"td"},"endon")," is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_notify"),(0,r.kt)("td",{parentName:"tr",align:null},"Variable being used on a ",(0,r.kt)("inlineCode",{parentName:"td"},"notify")," is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_waittill"),(0,r.kt)("td",{parentName:"tr",align:null},"Variable being used on a ",(0,r.kt)("inlineCode",{parentName:"td"},"waittill")," is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_wait"),(0,r.kt)("td",{parentName:"tr",align:null},"Time for a ",(0,r.kt)("inlineCode",{parentName:"td"},"wait")," is failing, if variable is used probably undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_EvalArray"),(0,r.kt)("td",{parentName:"tr",align:null},"Trying to do variable",(0,r.kt)("b",null,"[index]")," fails, variable might be undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_switch"),(0,r.kt)("td",{parentName:"tr",align:null},"The variable for the switch case table is undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_size"),(0,r.kt)("td",{parentName:"tr",align:null},"Doing ",(0,r.kt)("inlineCode",{parentName:"td"},"variable.size")," fails due to variable being undefined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_checkclearparams"),(0,r.kt)("td",{parentName:"tr",align:null},"Too many parameters might be getting passed to the function, or not the required ones")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OP_BoolNot"),(0,r.kt)("td",{parentName:"tr",align:null},"Doing a inverse of variable like ",(0,r.kt)("inlineCode",{parentName:"td"},"variable = !variable")," meaning undefined variable")))),(0,r.kt)("h3",{id:"variable-leaks"},"Variable leaks"),(0,r.kt)("p",null,"Variable leaks are when so much undefined behavior is happening that the game starts leaking variables. The GSC VM only has so many variables it can allocate, and for stability on a dedicated server, you must write good code. This can happen for various reasons, including more than just undefined variables. Threads that run ",(0,r.kt)("inlineCode",{parentName:"p"},"waittill"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"for")," loops, or even ",(0,r.kt)("inlineCode",{parentName:"p"},"while")," loops per player ",(0,r.kt)("i",null,"or")," level can ",(0,r.kt)("b",null,"easily leak")," if you are not properly ending them when the game ends, or when exitlevel is called."),(0,r.kt)("p",null,'The errors that occurs will be something along the lines of "child/parent variables maxed out". For example, this function below shows a function calls by a player that waits until the game is over, and then runs some code.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'waittill_game_end() // self == player\n{\n    //self endon("disconnect"); // let\'s act like our code doesn\'t have this\n    level endon("shutdownGame_called"); // absolute last notify to end threads\n\n    level waittill("game_ended");\n\n    print(va("%s has %s kills when game is ended", self.name, self.kills));\n}\n')),(0,r.kt)("p",null,"This function may look alright, but there are already some issues that can occur. If a player leaves the game, this code ",(0,r.kt)("b",null,"will still run."),' When that happens, the game will cry about "removed entity" errors because the player no longer exists. You now have a variable leak! To fix this, you add a ',(0,r.kt)("inlineCode",{parentName:"p"},'self endon("disconnect");')," so the thread ends when a player leaves."),(0,r.kt)("p",null,"Each function you create should always include a endon for ",(0,r.kt)("inlineCode",{parentName:"p"},"game_ended"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"shutdownGame_called")," if you need to end it at the very last second of the match. If it's a player thread, it should always endon ",(0,r.kt)("inlineCode",{parentName:"p"},"disconnect")," for the player entity."))}h.isMDXComponent=!0},8391:function(e,n,t){n.Z=t.p+"assets/images/runtime_error-6c79543a8a18fd7b6063c237ed99baa2.png"},9712:function(e,n,t){n.Z=t.p+"assets/images/runtime_error_code-b561a6a3f9524cebf9d7ef35ecdaa765.png"}}]);